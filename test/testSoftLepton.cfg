#! /bin/env cmsRun

process testSoftLepton = {

    # input file
    source = PoolSource {
        untracked vstring fileNames = {
          '/store/RelVal/2006/12/16/RelVal120BJets50-120/0000/00D1599A-578D-DB11-8741-001731AF68C7.root'
        }
        untracked int32 maxEvents = -1
    }

    # output file
    module out = PoolOutputModule {
        untracked string fileName = "file:btag_softlepton.root"
        untracked vstring outputCommands = {
            # drop all objects...
            "drop *",
            # ...but the input objects...
            "keep *_iterativeCone5CaloJets_*_*",
            "keep *_ctfWithMaterialTracks_*_*",
            "keep *_offlinePrimaryVerticesFromCTFTracks_*_*",
            "keep *_globalMuons_*_*",
            "keep *_btagSoftElectrons_*_*",
            # ...the b tag stuff...
            "keep *_softElectronTagInfos_*_*",
            "keep *_softElectronJetTags_*_*",
            "keep *_softMuonTagInfos_*_*",
            "keep *_softMuonJetTags_*_*",
            "keep *_softMuonNoIPJetTags_*_*",
            # ...and the MC infos
            "keep *_source_*_*",
            "keep *_VtxSmeared_*_*"
        }
    }

    # Message Logger
    include "FWCore/MessageLogger/data/MessageLogger.cfi"
    replace MessageLogger.cout.threshold = "INFO"
    
    # SoftLepton b tagging
    include "RecoBTag/SoftLepton/data/softLepton.cff"

    # module execution
    path softMuon     = { softMuonTagInfos, (softMuonJetTags & softMuonNoIPJetTags) }
    path softElectron = { btagSoftElectrons, softElectronTagInfos, softElectronJetTags }

    endpath outpath = { out }
}
