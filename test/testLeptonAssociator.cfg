#! /bin/env cmsRun

process TestEfficiency = {
    
    source = PoolSource {
        untracked vstring fileNames = { 
            'file:/tmp/fwyzard/04B6AEF9-65A0-DB11-A809-0002B3AFAFDB.root'
           #'/store/RelVal/2007/3/20/RelVal130pre6BJets50-120-DIGI-RECO/0000/2AF4E477-16D7-DB11-A481-0002B3AFAC5F.root'
        }
        untracked int32 maxEvents = -1
    }

    # Message Logger
    include "FWCore/MessageLogger/data/MessageLogger.cfi"
    replace MessageLogger.cout.threshold = "WARNING"
    replace MessageLogger.cerr.threshold = "ERROR"
    
    # Magnetic Field
    include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"
  
    # Tracking truth (TrackingParticles) 
    include "SimGeneral/MixingModule/data/mixNoPU.cfi"
    include "SimGeneral/TrackingAnalysis/data/trackingParticles.cfi"
    replace trackingParticles.HepMCDataLabels = { 'VtxSmeared' }
    
    # Track Associators
    include "SimTracker/TrackAssociation/data/TrackAssociatorByChi2.cfi"
    include "SimTracker/TrackAssociation/data/TrackAssociatorByHits.cfi"
    replace TrackAssociatorByHitsESProducer.MinHitFraction = 0.3

    module testAnalyzer = testLeptonAssociator {
        InputTag recoTracks      = ctfWithMaterialTracks
        InputTag standAloneMuons = standAloneMuons
        InputTag globalMuons     = globalMuons
        InputTag trackingTruth   = trackingParticles
        uint32   leptonFlavour   = 13
        double   minPt           = 1.2
    }
    
    path p = {
        mix, trackingParticles,
        testAnalyzer
    }
    
    #module out = PoolOutputModule {
    #    untracked string fileName = "file:out.root"
    #}
    #
    #endpath end = {
    #    out
    #}
}
