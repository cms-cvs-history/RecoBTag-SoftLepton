#! /bin/env cmsRun

process SoftLeptonTag = {

    # input file
    source = PoolSource {
        untracked vstring fileNames = {
            # RelVal 1.7.0-pre5: b jets 50-120 - 5100 events
            '/store/RelVal/2007/9/29/RelVal-RelValBJets_Pt_50_120-1191090129/0001/0C4577C7-096F-DC11-A95A-000423D98BE8.root',
            '/store/RelVal/2007/9/29/RelVal-RelValBJets_Pt_50_120-1191090129/0001/3A89C5A9-0C6F-DC11-BCAA-001617C3B78C.root',
            '/store/RelVal/2007/9/29/RelVal-RelValBJets_Pt_50_120-1191090129/0001/704E51A8-096F-DC11-AE1E-000423D98BC4.root',
            '/store/RelVal/2007/9/29/RelVal-RelValBJets_Pt_50_120-1191090129/0001/8A6C354F-0A6F-DC11-AE08-000423D98AF0.root',
            '/store/RelVal/2007/9/29/RelVal-RelValBJets_Pt_50_120-1191090129/0001/98C9998D-386F-DC11-AACC-000423D98E30.root',
            '/store/RelVal/2007/9/29/RelVal-RelValBJets_Pt_50_120-1191090129/0001/B24536B2-096F-DC11-9755-000423D98E6C.root',
            '/store/RelVal/2007/9/29/RelVal-RelValBJets_Pt_50_120-1191090129/0001/B2D3CEA9-096F-DC11-AE77-001617C3B5F0.root',
            '/store/RelVal/2007/9/29/RelVal-RelValBJets_Pt_50_120-1191090129/0001/C4F24694-0C6F-DC11-8E4E-001617DBD272.root',
            '/store/RelVal/2007/9/29/RelVal-RelValBJets_Pt_50_120-1191090129/0001/D83699AB-096F-DC11-8791-000423D99996.root',
            '/store/RelVal/2007/9/29/RelVal-RelValBJets_Pt_50_120-1191090129/0001/D86D5188-246F-DC11-8973-000423D9939C.root',
            '/store/RelVal/2007/9/29/RelVal-RelValBJets_Pt_50_120-1191090129/0001/FC2413AC-096F-DC11-A21E-00304885A754.root',
            # RelVal 1.7.0-pre5: c jets 50-120 - 4900 events
            '/store/RelVal/2007/9/29/RelVal-RelValCJets_Pt_50_120-1191090129/0001/12B44190-246F-DC11-A86D-000423D94C68.root',
            '/store/RelVal/2007/9/29/RelVal-RelValCJets_Pt_50_120-1191090129/0001/1ABD2EE8-326F-DC11-8B41-0016177CA778.root',
            '/store/RelVal/2007/9/29/RelVal-RelValCJets_Pt_50_120-1191090129/0001/724041A1-096F-DC11-972F-001617E30CA4.root',
            '/store/RelVal/2007/9/29/RelVal-RelValCJets_Pt_50_120-1191090129/0001/766179EF-266F-DC11-90D9-000423D6CA42.root',
            '/store/RelVal/2007/9/29/RelVal-RelValCJets_Pt_50_120-1191090129/0001/78FDDD93-0C6F-DC11-BEAE-000423D99896.root',
            '/store/RelVal/2007/9/29/RelVal-RelValCJets_Pt_50_120-1191090129/0001/8C2984BA-096F-DC11-8E15-000423D8F63C.root',
            '/store/RelVal/2007/9/29/RelVal-RelValCJets_Pt_50_120-1191090129/0001/9AE1DAD3-0F6F-DC11-836B-000423D985F4.root',
            '/store/RelVal/2007/9/29/RelVal-RelValCJets_Pt_50_120-1191090129/0001/B0EA128D-096F-DC11-B90A-000423D95008.root',
            '/store/RelVal/2007/9/29/RelVal-RelValCJets_Pt_50_120-1191090129/0001/E01B7599-0C6F-DC11-BBCC-000423D98EB4.root',
            '/store/RelVal/2007/9/29/RelVal-RelValCJets_Pt_50_120-1191090129/0001/ECA3D59D-096F-DC11-BB01-000423D98800.root',
            # RelVal 1.7.0-pre5: QCD jets 50-80 - 4800 events
            '/store/RelVal/2007/9/29/RelVal-RelValQCD_Pt_50_80-1191090129/0001/123EB297-096F-DC11-960F-00304885B264.root',
            '/store/RelVal/2007/9/29/RelVal-RelValQCD_Pt_50_80-1191090129/0001/2AD2A1A6-096F-DC11-BD91-000423D98844.root',
            '/store/RelVal/2007/9/29/RelVal-RelValQCD_Pt_50_80-1191090129/0001/58EA04A8-096F-DC11-8F09-000423D98BE8.root',
            '/store/RelVal/2007/9/29/RelVal-RelValQCD_Pt_50_80-1191090129/0001/78F8B19A-096F-DC11-91A0-000423D9899C.root',
            '/store/RelVal/2007/9/29/RelVal-RelValQCD_Pt_50_80-1191090129/0001/86CEB2D3-096F-DC11-85F4-000423D94C68.root',
            '/store/RelVal/2007/9/29/RelVal-RelValQCD_Pt_50_80-1191090129/0001/96D1509B-096F-DC11-8096-001617C3B5F0.root',
            '/store/RelVal/2007/9/29/RelVal-RelValQCD_Pt_50_80-1191090129/0001/AA974E80-246F-DC11-8AB8-000423D98E54.root',
            '/store/RelVal/2007/9/29/RelVal-RelValQCD_Pt_50_80-1191090129/0001/AE5E2DA1-096F-DC11-8CB0-001617E30CE8.root',
            '/store/RelVal/2007/9/29/RelVal-RelValQCD_Pt_50_80-1191090129/0001/C6075CC2-166F-DC11-93EC-000423D94D2C.root',
            '/store/RelVal/2007/9/29/RelVal-RelValQCD_Pt_50_80-1191090129/0001/E0CF60AC-096F-DC11-8D81-001617C3B78C.root',
            # RelVal 1.7.0-pre5: QCD jets 80-120 - 4800 events
            '/store/RelVal/2007/9/29/RelVal-RelValQCD_Pt_80_120-1191090129/0001/34E08E92-096F-DC11-A474-000423D98800.root',
            '/store/RelVal/2007/9/29/RelVal-RelValQCD_Pt_80_120-1191090129/0001/50881E91-256F-DC11-93B4-001617DBD356.root',
            '/store/RelVal/2007/9/29/RelVal-RelValQCD_Pt_80_120-1191090129/0001/5682E59A-096F-DC11-A6EE-001617E30F56.root',
            '/store/RelVal/2007/9/29/RelVal-RelValQCD_Pt_80_120-1191090129/0001/606E5099-096F-DC11-9B3E-000423D98BC4.root',
            '/store/RelVal/2007/9/29/RelVal-RelValQCD_Pt_80_120-1191090129/0001/60A4298F-096F-DC11-BCAB-001617E30CA4.root',
            '/store/RelVal/2007/9/29/RelVal-RelValQCD_Pt_80_120-1191090129/0001/7C410E92-096F-DC11-9EA9-000423D94AC8.root',
            '/store/RelVal/2007/9/29/RelVal-RelValQCD_Pt_80_120-1191090129/0001/86C0F3AD-246F-DC11-8696-000423D99AAA.root',
            '/store/RelVal/2007/9/29/RelVal-RelValQCD_Pt_80_120-1191090129/0001/9E0C9F71-246F-DC11-A478-000423D655A2.root',
            '/store/RelVal/2007/9/29/RelVal-RelValQCD_Pt_80_120-1191090129/0001/B0A90892-096F-DC11-B7C3-000423D98DC4.root',
            '/store/RelVal/2007/9/29/RelVal-RelValQCD_Pt_80_120-1191090129/0001/BAB115AF-096F-DC11-AEC2-001617C3B6EE.root',
            '/store/RelVal/2007/9/29/RelVal-RelValQCD_Pt_80_120-1191090129/0001/FE3372E1-096F-DC11-A19F-001617DBD288.root',
            '/store/RelVal/2007/9/29/RelVal-RelValQCD_Pt_80_120-1191090129/0001/FEA48A99-096F-DC11-84C2-000423D94A20.root'
        }
    }
    # events to analyze
    untracked PSet maxEvents = { untracked int32 input = -1 }

    # (re)run b-tagging algorithms
    include "RecoBTau/Configuration/data/RecoBTau_FrontierConditions.cff"
    include "RecoBTau/Configuration/data/RecoBTau.cff"
    include "RecoBTag/Configuration/data/RecoBTag.cff"

    path btag = { ic5JetTracksAssociatorAtVertex, btagging }

    #path softMuonPath     = { ckftracks, muonreco, softMuonTagInfos, (softMuonBJetTags & softMuonNoIPBJetTags) }
    #path softElectronPath = { btagSoftElectrons, softElectronTagInfos, softElectronBJetTags }

    # Analysis and validation plots
    module  bTagSoftLeptonPlots = bTagSoftLeptonAnalysis from "RecoBTag/Analysis/data/bTagSoftLeptonAnalysis.cfi" 
    replace bTagSoftLeptonPlots.jetTagModuleLabel = { "softMuonBJetTags", "softMuonNoIPBJetTags", "softElectronBJetTags" }
    replace bTagSoftLeptonPlots.rootfile   = "softLepton.root"
    replace bTagSoftLeptonPlots.produceEps = false
    replace bTagSoftLeptonPlots.producePs  = true

    module  bTagTrackIPPlots = bTagTrackIPAnalysis from "RecoBTag/Analysis/data/bTagTrackIPAnalysis.cfi"
    replace bTagTrackIPPlots.jetTagModuleLabel = { "jetProbabilityBJetTags", "trackCountingHighPurBJetTags", "trackCountingHighEffBJetTags", "impactParameterMVABJetTags" }
    replace bTagTrackIPPlots.rootfile   = "trackIP.root"
    replace bTagTrackIPPlots.produceEps = false
    replace bTagTrackIPPlots.producePs  = true

    # module execution
    path plots = { bTagSoftLeptonPlots, bTagTrackIPPlots }

    schedule = { btag, plots }
}
