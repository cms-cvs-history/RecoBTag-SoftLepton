#! /bin/env cmsRun

process SoftLeptonTag = {

    # input file
    source = PoolSource {
        untracked vstring fileNames = {
            # RelVal 1.7.0-pre3: b jets 50-120 - 5025 events
            '/store/mc/2007/9/11/RelVal-RelValBJets_Pt_50_120-1189522824/0000/00878165-1161-DC11-A7E3-003048754FB3.root',
            '/store/mc/2007/9/11/RelVal-RelValBJets_Pt_50_120-1189522824/0000/18C0ABB2-EE60-DC11-A394-001731AF698F.root',
            '/store/mc/2007/9/11/RelVal-RelValBJets_Pt_50_120-1189522824/0000/24339CAC-F860-DC11-B085-0018F3D0962C.root',
            '/store/mc/2007/9/11/RelVal-RelValBJets_Pt_50_120-1189522824/0000/4A59D7F4-F160-DC11-BD4A-00304875AACB.root',
            '/store/mc/2007/9/11/RelVal-RelValBJets_Pt_50_120-1189522824/0000/4E912D4E-E860-DC11-9CD8-0018F3D09600.root',
            '/store/mc/2007/9/11/RelVal-RelValBJets_Pt_50_120-1189522824/0000/662D1C5D-EB60-DC11-B44D-001731AF68CF.root',
            '/store/mc/2007/9/11/RelVal-RelValBJets_Pt_50_120-1189522824/0000/9652C4B1-EE60-DC11-824F-001731AF684D.root',
            '/store/mc/2007/9/11/RelVal-RelValBJets_Pt_50_120-1189522824/0000/B0A7AFA7-EE60-DC11-86AD-001731A28675.root',
            '/store/mc/2007/9/11/RelVal-RelValBJets_Pt_50_120-1189522824/0000/D691D05B-EB60-DC11-B1C9-001A92810ADE.root',
            # RelVal 1.7.0-pre3: c jets 50-120 - 5000 events
            '/store/mc/2007/9/11/RelVal-RelValCJets_Pt_50_120-1189522954/0000/164589BB-BC60-DC11-B698-001731AF66A5.root',
            '/store/mc/2007/9/11/RelVal-RelValCJets_Pt_50_120-1189522954/0000/18F041F1-E460-DC11-8851-001A92810ADE.root',
            '/store/mc/2007/9/11/RelVal-RelValCJets_Pt_50_120-1189522954/0000/2A585DBC-3C62-DC11-824E-001A92971B0E.root',
            '/store/mc/2007/9/11/RelVal-RelValCJets_Pt_50_120-1189522954/0000/3A4454AA-EE60-DC11-92F5-001A92810ADE.root',
            '/store/mc/2007/9/11/RelVal-RelValCJets_Pt_50_120-1189522954/0000/6E5558F3-E860-DC11-9C45-003048769D4B.root',
            '/store/mc/2007/9/11/RelVal-RelValCJets_Pt_50_120-1189522954/0000/BCCFECFC-E660-DC11-BCCC-001731AF6B75.root',
            '/store/mc/2007/9/11/RelVal-RelValCJets_Pt_50_120-1189522954/0000/C0AF0298-E360-DC11-B1A0-001731AF66BB.root',
            '/store/mc/2007/9/11/RelVal-RelValCJets_Pt_50_120-1189522954/0000/D00302FF-E660-DC11-91BA-00304875ABE9.root',
            '/store/mc/2007/9/11/RelVal-RelValCJets_Pt_50_120-1189522954/0000/F27E6DD7-BA60-DC11-A492-0018F3D0960E.root',
            # RelVal 1.7.0-pre3: QCD jets 50-80 - 5025 events
            '/store/mc/2007/9/11/RelVal-RelValQCD_Pt_50_80-1189522539/0000/5A440924-1D61-DC11-94FB-0018F3D096D8.root',
            '/store/mc/2007/9/11/RelVal-RelValQCD_Pt_50_80-1189522539/0000/748B87D2-0761-DC11-8370-003048726FF7.root',
            '/store/mc/2007/9/11/RelVal-RelValQCD_Pt_50_80-1189522539/0000/AAFBCFB4-3661-DC11-8A6E-001A92810AEA.root',
            '/store/mc/2007/9/11/RelVal-RelValQCD_Pt_50_80-1189522539/0000/B0DB85F8-FC60-DC11-8E7F-001A92971B5E.root',
            '/store/mc/2007/9/11/RelVal-RelValQCD_Pt_50_80-1189522539/0000/B48C2D30-0461-DC11-A9F3-003048767DFB.root',
            '/store/mc/2007/9/11/RelVal-RelValQCD_Pt_50_80-1189522539/0000/C80F0D32-0461-DC11-BA3A-001A928116EA.root',
            '/store/mc/2007/9/11/RelVal-RelValQCD_Pt_50_80-1189522539/0000/DAF84B92-0061-DC11-A004-001BFCDBD130.root',
            '/store/mc/2007/9/11/RelVal-RelValQCD_Pt_50_80-1189522539/0000/DED4A527-0461-DC11-8FA6-0018F3D0960A.root',
            '/store/mc/2007/9/11/RelVal-RelValQCD_Pt_50_80-1189522539/0000/E6C63CCF-0761-DC11-9808-001BFCDBD1BC.root',
            # RelVal 1.7.0-pre3: QCD jets 80-120 - 5025 events
            '/store/mc/2007/9/11/RelVal-RelValQCD_Pt_80_120-1189522686/0000/0A65AEBE-F360-DC11-88E2-0018F3D096BC.root',
            '/store/mc/2007/9/11/RelVal-RelValQCD_Pt_80_120-1189522686/0000/349876B8-FC60-DC11-8B73-001A92971B90.root',
            '/store/mc/2007/9/11/RelVal-RelValQCD_Pt_80_120-1189522686/0000/3CDD8CB0-BA60-DC11-9A5C-001BFCDBD100.root',
            '/store/mc/2007/9/11/RelVal-RelValQCD_Pt_80_120-1189522686/0000/50DA80A9-F860-DC11-87ED-0018F3D09708.root',
            '/store/mc/2007/9/11/RelVal-RelValQCD_Pt_80_120-1189522686/0000/7830BEAC-F860-DC11-9A1E-003048723C17.root',
            '/store/mc/2007/9/11/RelVal-RelValQCD_Pt_80_120-1189522686/0000/78EEAF74-FE60-DC11-9BAF-003048767E5D.root',
            '/store/mc/2007/9/11/RelVal-RelValQCD_Pt_80_120-1189522686/0000/8238CC41-BC60-DC11-B8B6-001731AF664F.root',
            '/store/mc/2007/9/11/RelVal-RelValQCD_Pt_80_120-1189522686/0000/D06A81C7-BA60-DC11-B1F7-001A92971AA4.root',
            '/store/mc/2007/9/11/RelVal-RelValQCD_Pt_80_120-1189522686/0000/D4E5E61E-CE61-DC11-96F9-00304875A33F.root',
            '/store/mc/2007/9/11/RelVal-RelValQCD_Pt_80_120-1189522686/0000/DE57EF36-0561-DC11-8FE9-001731AF68AD.root',
            '/store/mc/2007/9/11/RelVal-RelValQCD_Pt_80_120-1189522686/0000/EED0AF03-2161-DC11-9D2B-001A92971B90.root'
        }
    }
    # events to analyze
    untracked PSet maxEvents = { untracked int32 input = -1 }

    # (re)run b-tagging algorithms
    include "RecoBTau/Configuration/data/RecoBTau_FrontierConditions.cff"
    include "RecoBTau/Configuration/data/RecoBTau.cff"
    include "RecoBTag/Configuration/data/RecoBTag.cff"

    path btag = { ic5JetTracksAssociatorAtVertex, btagging }

    #path softMuonPath     = { ckftracks, muonreco, softMuonTagInfos, (softMuonBJetTags & softMuonNoIPBJetTags) }
    #path softElectronPath = { btagSoftElectrons, softElectronTagInfos, softElectronBJetTags }

    # Analysis and validation plots
    module  bTagSoftLeptonPlots = bTagSoftLeptonAnalysis from "RecoBTag/Analysis/data/bTagSoftLeptonAnalysis.cfi" 
    replace bTagSoftLeptonPlots.jetTagModuleLabel = { "softMuonBJetTags", "softMuonNoIPBJetTags", "softElectronBJetTags" }
    replace bTagSoftLeptonPlots.rootfile   = "softLepton.root"
    replace bTagSoftLeptonPlots.produceEps = false
    replace bTagSoftLeptonPlots.producePs  = true

    module  bTagTrackIPPlots = bTagTrackIPAnalysis from "RecoBTag/Analysis/data/bTagTrackIPAnalysis.cfi"
    replace bTagTrackIPPlots.jetTagModuleLabel = { "jetProbabilityBJetTags", "trackCountingHighPurBJetTags", "trackCountingHighEffBJetTags", "impactParameterMVABJetTags" }
    replace bTagTrackIPPlots.rootfile   = "trackIP.root"
    replace bTagTrackIPPlots.produceEps = false
    replace bTagTrackIPPlots.producePs  = true

    # module execution
    path plots = { bTagSoftLeptonPlots, bTagTrackIPPlots }

    schedule = { btag, plots }
}
